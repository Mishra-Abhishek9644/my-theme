<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ page_title }}</title>

    {{ content_for_header }}

    {{ 'main.css' | asset_url | stylesheet_tag }}

    <!-- AOS CSS -->
    <link
      href="https://unpkg.com/aos@2.3.1/dist/aos.css"
      rel="stylesheet"
    />

    <!-- Your Tailwind browser build -->
    <script src="{{ 'browser.js' | asset_url }}" defer></script>
  </head>
  
<script>
document.addEventListener("DOMContentLoaded", () => {

  /* âœ… Get Wishlist */
  function getWishlist() {
    return JSON.parse(localStorage.getItem("wishlist")) || [];
  }

  /* âœ… Save Wishlist */
  function saveWishlist(wishlist) {
    localStorage.setItem("wishlist", JSON.stringify(wishlist));
  }

  /* âœ… Update Navbar Badge Count */
  function updateWishlistBadge() {
    let wishlist = getWishlist();
    let badge = document.getElementById("wishlist-count");

    if (!badge) return;

    if (wishlist.length > 0) {
      badge.innerText = wishlist.length;
      badge.classList.remove("hidden");
    } else {
      badge.classList.add("hidden");
    }
  }

  /* âœ… Toggle Wishlist Button */
  function setupWishlistButtons() {
    let wishlist = getWishlist();

    document.querySelectorAll(".wishlist-btn").forEach(btn => {

      let id = btn.dataset.id;

      // âœ… Initial State
      if (wishlist.includes(id)) {
        btn.innerText = "ğŸ’š Wishlisted";
      } else {
        btn.innerText = "â¤ï¸ Add to Wishlist";
      }

      // âœ… Click Toggle
      btn.addEventListener("click", () => {

        wishlist = getWishlist();

        if (wishlist.includes(id)) {
          wishlist = wishlist.filter(item => item !== id);
          btn.innerText = "â¤ï¸ Add to Wishlist";
        } else {
          wishlist.push(id);
          btn.innerText = "ğŸ’š Wishlisted";
        }

        saveWishlist(wishlist);

        // âœ… Update Badge Immediately
        updateWishlistBadge();
      });

    });
  }

  /* âœ… Run on Page Load */
  setupWishlistButtons();
  updateWishlistBadge();

});
</script>




  <body>
    {% section 'header' %}

    <main>
      {{ content_for_layout }}
    </main>

    {% section 'footer' %}

    <!-- AOS JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"defer></script>

    <!-- Main JS -->
    <script src="{{ 'main.js' | asset_url }}" defer></script>
  </body>
</html>
